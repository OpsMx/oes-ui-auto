<div *ngIf="!deployementLoading" class="main_content p-0 bg-white">
  <div class="d-flex">
    <div class="leftBox bg-white mw-250">
    <div class=" text-muted text-center pt-3" *ngIf="!applicationExists">No Applications! </div>
      <div class="leftBox_body text-muted text-center" *ngIf="applicationExists">
        <form [formGroup]="applicationForm" novalidate class="example-form maxwidth100" *ngIf = "showSearch">
          <mat-form-field>
            <input #focus type="text" matInput placeholder="Select Application" floatLabel="always" formControlName="application" [matAutocomplete]="autoApplication" 
            />
            <mat-autocomplete (optionSelected)="onSelectionChangeApplication($event.option.value)" autoActiveFirstOption #autoApplication="matAutocomplete" >
              <mat-option *ngFor="let applications of applicationListOptions | async" [value]="applications.applicationName">
                {{ applications.applicationName }}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>
          <button type="button" class="close closed pull-right" aria-label="Close" (click)="showSearch=false">
            <span aria-hidden="true">&times;</span>
          </button>
         </form>
    
          <div class="appName border" style="font-size: 16px; margin-top: 10px;" *ngIf="!showSearch"><b>{{selectedApplicationName}}</b> &nbsp;&nbsp;  <div class=" pull-right absolute"><i class="fas fa-search" (click)="showSearchFunc()" aria-hidden="true"></i></div>
            
          </div>
     
        <div class="app-status" style="margin-top: 10px;" *ngIf = "!showSearch">
          <div class="pull-left" [ngClass]= "{'text-danger':deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'FAIL','text-success':deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'SUCCESS','text-warning':deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'REVIEW','text-muted':deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'INPROGRESS'}">{{deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase()}}
            <a *ngIf="deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'INPROGRESS' || deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'IN PROGRESS'" class="ci_run ico16 popover-hover"><i class="fas fa-circle-notch fa-spin"></i></a> &nbsp;&nbsp;
            <a *ngIf="deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'INPROGRESS' || deploymentApplicationHealth['applicationHealthStatus']?.toUpperCase() === 'IN PROGRESS'" data-toggle="tooltip" data-placement="top" title="Stop Running Canary"><i (click)="cancelRunningCanary(control.value)" class="fa fa-stop showElementHover stop-icon" aria-hidden="true"></i></a>
          </div>
          
          <div class="pull-right">{{calculateDiff(deploymentApplicationHealth['runStartTime'])}} </div>
        </div>
 
        <div class="input-group" *ngIf="canaryIdExists && !showSearch">
          <div class="input-group-prepend">
            <button [ngStyle]="{cursor : decrementDisable ? 'no-drop' :'pointer' }" class="input-group-text" (click)="decrementCanaryRun(control.value)" type="button" id="button-addon1"><i class="fa fa-angle-left"></i></button>
          </div>
          <form class="example-form">
            <input type="text" class="form-control text-center"
                   [formControl]="control"
                   [matAutocomplete]="autoCanaries" name="inputVar" >
            <mat-autocomplete #autoCanaries="matAutocomplete" (optionSelected)="onSelectionChangeCanaryRun($event.option.value)">
              <mat-option *ngFor="let canaryId of filteredCanaries | async" [value]="canaryId" >
                {{canaryId}}
              </mat-option>
            </mat-autocomplete>
          </form>
          <div  class="input-group-prepend">
            <button  [ngStyle]="{cursor : incredementDisable ? 'no-drop' :'pointer' }" (click)="incrementCanaryRun(control.value)" class="input-group-text" type="button" id="button-addon1"><i class="fa fa-angle-right"></i></button>
          </div>
          <br>
        </div>
      </div>
      <!-- /.leftBox_header -->
      <div class="leftBox_body" *ngIf="!showSearch">
        <table class="table-sm table-avenir table-bordered serviceTable" *ngIf="serviceIdExists">
          <tbody>
            
            <tr>
              <td class="bgDark" rowspan="4">Services <br> <span class="service-count">{{serviceListLength}}</span></td> 
              <td> &nbsp;&nbsp;&nbsp;Failed</td>
              <td class="cv_heighlight text-danger">{{deploymentApplicationHealth ? deploymentApplicationHealth['noOfFailed'] : ''}}</td>
           </tr>
            <tr>
              <td>Review</td>
              <td class="cv_heighlight text-warning">{{deploymentApplicationHealth ? deploymentApplicationHealth['noOfReview'] : ''}}</td>
            </tr>
            <tr>
              <td>Success</td>
              <td class="cv_heighlight text-success">{{deploymentApplicationHealth ? deploymentApplicationHealth['noOfSuccess'] : ''}}</td>
            </tr>
            <tr>
              <td>InProgress</td>
              <td class="cv_heighlight text-muted">{{deploymentApplicationHealth ? deploymentApplicationHealth['noOfInProgress'] : ''}}</td>
            </tr> 
          </tbody>
        </table>
        <table class="table-sm table-avenir serviceTable" *ngIf="!serviceIdExists && deploymentApplicationHealth['applicationHealthStatus'] != 'IN PROGRESS' ">
          <tbody>
            <tr>
              <td>
              No Services!
            </td>
          </tr>
          </tbody>
          </table>
        <!-- /.table -->
  
    <div class="page_access d-flex text-right p-3">
      <div class="mr-auto" *ngIf="serviceListLength >= 10">
          <div class="input-group input-group_search">
            <div class="input-group-prepend">
              <span class="input-group-text" id="modal-search"><i class="fa fa-search"></i></span>
            </div>
            <input type="text" class="form-control" [(ngModel)]="searchData" (keyup)="onSearch()" style="padding-right: 20px;" />
              <span *ngIf="searchData.length != 0"><i class="fa fa-times clearSearch"(click)="searchData=''"></i></span>
            <i (click)="refreshList()" data-toggle="tooltip" data-placement="top" title="Refresh List" class="refresh-icon fa refreshList">&#xf021;</i>
          </div>
        </div>
  </div>
      <table class="table table-sm table-avenir table-no-bordered table-no-dots table-responsive">
        <tbody>
          <tr *ngIf="serviceListLength > 0">
            <th >Service</th>
            <th>Score</th>
            <th>Status</th>
          </tr>
          <ng-container *ngFor="let service of currentPage | filter:searchData; let i=index">
          <tr [ngClass]="{'active-service': service.serviceId == selectedServiceId}">
            <td class="service-selection " style="padding-left: 2px !important;" (click)="onClickService(service)">{{service.serviceName}}</td>
            <td width="50" style="text-align: center;" [ngClass]= "{'text-danger':service.status === 'Fail','text-success':service.status === 'Success','text-warning':service.status === 'Review','text-muted':service.status === 'InProgress'}">{{service.finalScore >= 0 ? (service.finalScore | number: '1.0-0') : 'N/A'}}</td>
            <td width="50" style="text-align: center;"  [ngClass]= "{'text-danger':service.status === 'Fail','text-success':service.status === 'Success','text-warning':service.status === 'Review','text-muted':service.status === 'InProgress'}">{{service.status}}</td>
          </tr> 
        </ng-container>               
        </tbody>
      </table>
      <div class="table-footer gray-strip px-3 py-2" *ngIf="serviceListLength >= 10">
        <div class="form-inline">
          <span class="mr-2">Per page</span>
          <select class="form-control" [(ngModel)]="perPageData" (change)="onChangePerPageData()">
            <option value="10">10</option>
            <option value="15">15</option>
            <option value="20">20</option>
            <option value="25">25</option>
          </select>

          <ul class="pagination ml-auto mb-0">
            <li class="page-item" (click)="pagePrev()"><a class="page-link"><i class="fa fa-angle-left"></i></a></li>
            <li class="page-item {{page.currentPage === page.pageNo ? 'active' : ''}}"
              (click)=showPage(page.currentPage)><a class="page-link">{{page.currentPage}}</a></li>
            <li class="page-item {{page.currentPage+1 === page.pageNo ? 'active' : ''}}"
              *ngIf="(page.pageNo*page.pageSize) < serviceListLength || 
                        page.currentPage+1 == page.pageNo || page.currentPage+1 == page.pageNo-1 ? true : false" (click)=showPage(page.currentPage+1)>
              <a class="page-link">{{page.currentPage+1}}</a>
            </li>
            <li class="page-item {{page.currentPage+2 === page.pageNo ? 'active' : ''}}"
              *ngIf="((page.pageNo+1)*page.pageSize) < serviceListLength || 
                         page.currentPage+2 == page.pageNo ||
                         ((page.currentPage+2)*page.pageSize< serviceListLength? true : ((page.currentPage+2)*page.pageSize)-serviceListLength < page.pageSize? true : false) ? true : false"
              (click)=showPage(page.currentPage+2)><a class="page-link">{{page.currentPage+2}}</a>
            </li>
            <li class="page-item" (click)="pageNext()"><a class="page-link"><i class="fa fa-angle-right"></i></a></li>
          </ul>
        </div>
        <!-- /.per_page -->
      </div>
      <!-- /.table-footer px-3 py-2 -->
    </div>
  </div>
  <div class="modal bd-example-modal-lg fade" id="manualTrigger" tabindex="-1" role="dialog" aria-labelledby="manualTriggerLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-width" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Manual Canary Trigger</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="modal-body p-0">
          <!-- Enable the below code for Form / Editor options -->
          <div class="tab-default pt-3">
            <ul class="nav tab-lined nav-tabs mb-2" id="myTab" role="tablist" (click)="onManualTriggerClickTab($event)">
              <li class="nav-item" >
                <a class="nav-link active" id="manualTrigger-form-tab" data-toggle="tab" role="tab" aria-controls="manualTrigger-form" aria-selected="true">Form</a>
              </li>
              <li  class="nav-item">
                <a class="nav-link"  id="manualTrigger-editor-tab" data-toggle="tab" role="tab" aria-controls="manualTrigger-editor" aria-selected="true">Editor</a>
              </li>            
            </ul>
            <div class="tab-content" id="manutaltriggertab">
              
              <div id="manualTrigger-form" role="tabpanel" aria-labelledby="manualTrigger-form-tab" >         
                  <div  class="col-12 maindiv" *ngIf = "selectedManualTriggerTab === 'manualTrigger-form-tab'" >
                    <form [formGroup]="manualTriggerForm" >
                      <div class="form-group text-muted">
                        <label>Application <span data-toggle="tooltip" data-placement="right" title="Name of the application"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>                          
                        <div class="d-flex align-items-center">
                          <select class="form-control col-sm-6 mr-2" formControlName="application" (change)="onChangeApplicationManualTrigger($event.target.selectedIndex)" [ngClass]="manualTriggerForm.get('application').invalid && manualTriggerForm.get('application').touched ? 'is-invalid':''">
                            <option value="" [disabled]="true">Select</option>                            
                            <option *ngFor="let application of deployementApplications" value="{{application.applicationName}}"  >
                              {{application.applicationName}}</option>                           
                          </select>
                          <span class="mandatory">*</span>
                        </div>                        
                        <span *ngIf="manualTriggerForm.get('application').invalid && manualTriggerForm.get('application').touched" class="invalid-feedback"></span>
                      </div>
                      <!-- <div class="form-group text-muted">
                        <label>User Name <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <input type="text" class="form-control col-sm-6" autofocus="true" />
                      </div> -->
                      <div class="form-group text-muted">
                        <label>Analysis Lifetime <span data-toggle="tooltip" title="The time in hours for which the Canary Analysis should be run"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control mr-2 col-sm-6" formControlName="lifetimeHours" [ngClass]="manualTriggerForm.get('lifetimeHours').invalid && manualTriggerForm.get('lifetimeHours').touched ? 'is-invalid':''"/>
                          <span>hours</span><span class="mandatory ml-2">*</span>
                        </div>
                        <span *ngIf="manualTriggerForm.get('lifetimeHours').invalid && manualTriggerForm.get('lifetimeHours').touched" class="invalid-feedback"></span>
                        <!-- <span *ngIf="manualTriggerForm.get('lifetimeHours').errors['required']"> Analysis Lifetime is required</span> -->
                      </div>
                      <!-- <div class="form-group text-muted">
                        <label>Combined Canary Result Strategy <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <select class="form-control col-sm-6">
                          <option value="">Select Strategy</option>
                          <option>Option</option>
                          <option>Option</option>
                          <option>Option</option>
                        </select>
                      </div> -->
                      <!-- <div class="form-group text-muted position-relative">
                        <label>Metric Successful Score <span data-toggle="tooltip" title="The score under which the Metric Analysis should fail"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control mr-2 col-sm-6" formControlName="successMetricsResultScore" [ngClass]="manualTriggerForm.get('successMetricsResultScore').invalid && manualTriggerForm.get('successMetricsResultScore').touched ? 'is-invalid':''"/>
                          <span class="mandatory">*</span>                                                 
                        </div>
                        <span *ngIf="manualTriggerForm.get('successMetricsResultScore').invalid && manualTriggerForm.get('successMetricsResultScore').touched" class="invalid-feedback"></span>
                      </div> -->
                      <!-- <div class="form-group text-muted">
                        <label>Metric Unhealthy Score <span data-toggle="tooltip" title="The score above which the Metric Analysis should be a pass"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control col-sm-6 mr-2" formControlName="minimumMetricsResultScore" [ngClass]="manualTriggerForm.get('minimumMetricsResultScore').invalid && manualTriggerForm.get('minimumMetricsResultScore').touched ? 'is-invalid':''"/>
                          <span class="mandatory">*</span>
                        </div>
                        <span *ngIf="manualTriggerForm.get('minimumMetricsResultScore').invalid && manualTriggerForm.get('minimumMetricsResultScore').touched" class="invalid-feedback"></span>
                      </div> -->
                      <div class="form-group text-muted position-relative">
                        <label>Successful Score <span data-toggle="tooltip" title="The score under which the Analysis should fail"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control col-sm-6 mr-2" formControlName="canaryResultScore" [ngClass]="manualTriggerForm.get('canaryResultScore').invalid && manualTriggerForm.get('canaryResultScore').touched ? 'is-invalid':''"/>
                          <span class="mandatory">*</span>  
                        </div> 
                        <span *ngIf="manualTriggerForm.get('canaryResultScore').invalid && manualTriggerForm.get('canaryResultScore').touched" class="invalid-feedback"></span>                     
                      </div>                      
                      <div class="form-group text-muted">
                        <label>Unhealthy Score <span data-toggle="tooltip" title="The score above which the Analysis should be a pass"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control col-sm-6 mr-2" formControlName="minimumCanaryResultScore" [ngClass]="manualTriggerForm.get('minimumCanaryResultScore').invalid && manualTriggerForm.get('minimumCanaryResultScore').touched ? 'is-invalid':''"/>
                          <span class="mandatory">*</span>
                        </div>
                        <span *ngIf="manualTriggerForm.get('minimumCanaryResultScore').invalid && manualTriggerForm.get('minimumCanaryResultScore').touched" class="invalid-feedback"></span>
                      </div>
                      <!-- <div class="formgroup" [formGroup]="formGroup"> -->
                        <div class="form-group text-muted">
                          <label class="mr-2">Baseline Start Time<span data-toggle="tooltip" title="Baseline Start Time"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>                          
                          <mat-form-field>
                            <input matInput [ngxMatDatetimePicker]="picker" placeholder="Choose a date" formControlName="baselineStartTimeMs" [ngClass]="manualTriggerForm.get('baselineStartTimeMs').invalid && manualTriggerForm.get('baselineStartTimeMs').touched ? 'is-invalid':''">
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <ngx-mat-datetime-picker #picker touchUi [showSeconds]="showSeconds"></ngx-mat-datetime-picker>
                          </mat-form-field>
                          <span class="mandatory ml-2">*</span>
                        </div>
                        <span *ngIf="manualTriggerForm.get('baselineStartTimeMs').invalid && manualTriggerForm.get('baselineStartTimeMs').touched" class="invalid-feedback"></span>

                        <div class="form-group text-muted">
                          <label class="mr-2">New Release Start Time<span data-toggle="tooltip" title="Canary Start Time"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                          <mat-form-field>
                            <input matInput [ngxMatDatetimePicker]="picker1" placeholder="Choose a date" formControlName="canaryStartTimeMs" [ngClass]="manualTriggerForm.get('canaryStartTimeMs').invalid && manualTriggerForm.get('canaryStartTimeMs').touched ? 'is-invalid':''">
                            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                            <ngx-mat-datetime-picker #picker1 touchUi [showSeconds]="showSeconds"></ngx-mat-datetime-picker>
                          </mat-form-field>
                          <span class="mandatory ml-2">*</span>
                         </div>
                         <span *ngIf="manualTriggerForm.get('canaryStartTimeMs').invalid && manualTriggerForm.get('canaryStartTimeMs').touched" class="invalid-feedback"></span>
                        
                      <!-- </div> -->
                      <div class="text-divider">
                        <h4>Scope</h4>
                      </div>

                      <!-- <div class="form-group text-muted">
                        <label>Metric Template Name <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <select class="form-control col-sm-6">
                          <option value="">Select Metric Template</option>
                          <option>Option</option>
                          <option>Option</option>
                          <option>Option</option>
                        </select>
                      </div>
                      <div class="form-group text-muted">
                        <label>Log Template Name <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <select class="form-control col-sm-6">
                          <option value="">Select Log Template</option>
                          <option>Option</option>
                          <option>Option</option>
                          <option>Option</option>
                        </select>
                      </div> -->
                      <div class="form-group text-muted">
                        <label>Begin Canary Analysis After Mins <span data-toggle="tooltip" title="Time to enable warming up of the container"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>                          
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control mr-2 col-sm-6" formControlName="beginCanaryAnalysisAfterMins" [ngClass]="manualTriggerForm.get('beginCanaryAnalysisAfterMins').invalid && manualTriggerForm.get('beginCanaryAnalysisAfterMins').touched ? 'is-invalid':''"/>
                          <span>minutes</span><span class="mandatory ml-2">*</span>
                        </div>
                        <span *ngIf="manualTriggerForm.get('beginCanaryAnalysisAfterMins').invalid && manualTriggerForm.get('beginCanaryAnalysisAfterMins').touched" class="invalid-feedback"></span>
                      </div>
                      <div class="form-group text-muted">
                        <label>Canary Analysis Interval Mins <span data-toggle="tooltip" title="Intervals in which metric-data is fetched and analysed"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></label>
                        <div class="d-flex align-items-center">
                          <input type="number" class="form-control mr-2 col-sm-6" formControlName="canaryAnalysisIntervalMins" [ngClass]="manualTriggerForm.get('canaryAnalysisIntervalMins').invalid && manualTriggerForm.get('canaryAnalysisIntervalMins').touched ? 'is-invalid':''"/>
                          <span>minutes</span><span class="mandatory ml-2">*</span>
                        </div>
                        <span *ngIf="manualTriggerForm.get('canaryAnalysisIntervalMins').invalid && manualTriggerForm.get('canaryAnalysisIntervalMins').touched" class="invalid-feedback"></span>
                      </div>

                      <div class="text-divider">
                        <h4>Log Identifiers</h4>
                      </div>

                      <div class="row" *ngIf="servicesOfApplication?.length != 0">
                        <div class="col-12">
                          <form [formGroup]="logServiceForm">
                            <div class="row">
                              <div class="col-12">
                                <div class="form-group">
                                  <table class="table table-outline table-md" formArrayName="identifiers">
                                    <thead>
                                      <tr>
                                       <th>Service</th>
                                       <th>Baseline <span data-toggle="tooltip" title="Unique id of the log baseline"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></th>
                                       <th>New Release <span data-toggle="tooltip" title="Unique id of the log new release"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></th>                                        
                                       <th class="text-right"><a (click)="addLogServiceMT()" data-toggle="tooltip" data-placement="top" data-original-title="Add next service" *ngIf="servicesOfApplication?.length > 0 && (logServiceForm.value.identifiers.length < servicesOfApplication?.length)"><i class="fas fa-plus"></i></a></th>
                                      </tr>
                                    </thead>
                                    <tbody *ngFor="let logservice of logServiceForm.get('identifiers')['controls']; let i=index">                              
                                      <tr [formGroupName]=i>
                                        <td class="px-1">
                                          <div class="d-flex align-items-center">
                                            <select class="form-control" formControlName="service" [ngClass]="logservice.get('service').invalid && logservice.get('service').touched ? 'is-invalid':''">
                                              <option value="" [disabled]="true">Select</option>                            
                                              <option *ngFor="let service of servicesOfApplication" value="{{service.name}}">
                                                {{service.name}}</option>                           
                                            </select>
                                            <span class="mandatory ml-2">*</span>
                                          </div>
                                          <span *ngIf="logservice.get('service').invalid && logservice.get('service').touched" class="invalid-feedback"></span>
                                        </td>
                                        <td class="px-1">
                                          <div class="d-flex align-items-center">
                                            <input type="text" class="form-control" formControlName="baseline" placeholder="{container_name: baseapp}" [ngClass]="logservice.get('baseline').invalid && logservice.get('baseline').touched ? 'is-invalid':''">
                                            <span class="mandatory ml-2">*</span>
                                          </div>
                                          <span *ngIf="logservice.get('baseline').invalid && logservice.get('baseline').touched" class="invalid-feedback"></span>
                                        </td>
                                        <td class="px-1">
                                          <div class="d-flex align-items-center">
                                            <input type="text" class="form-control" formControlName="canary" placeholder="{container_name: canaryapp}" [ngClass]="logservice.get('canary').invalid && logservice.get('canary').touched ? 'is-invalid':''">
                                            <span class="mandatory ml-2">*</span>
                                          </div>
                                          <span *ngIf="logservice.get('baseline').invalid && logservice.get('baseline').touched" class="invalid-feedback"></span>
                                        </td>
                                        <!-- <td class="px-1">
                                         <a (click)="deleteLogService(logservice,i)" class="text-muted"><i class="fas fa-trash-alt"></i></a>
                                        </td> -->
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                                <!-- /.form-group -->
                              </div>
                              <!-- /.col-6 -->
                            </div>
                            <!-- /.row -->   
                           </form> 
                        </div>
                      </div>

                      <div class="text-divider">
                        <h4>Metric Identifiers</h4>
                      </div>

                      <div class="row" *ngIf="servicesOfApplication?.length != 0">
                        <div class="col-12">
                          <form [formGroup]="metricServiceForm">
                            <div class="row">
                              <div class="col-12">
                                <div class="form-group">
                                  <table class="table table-outline table-md" formArrayName="identifiers">
                                    <thead>
                                      <tr>
                                       <th>Service</th>
                                       <th>Baseline <span data-toggle="tooltip" title="Unique id of the metric baseline"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></th>
                                       <th>New Release <span data-toggle="tooltip" title="Unique id of the metric new release"><img src="../../../assets/images/help_icon.png" alt="icon" /></span></th>                                        
                                       <th class="text-right"><a (click)="addMetricServiceMT()" data-toggle="tooltip" data-placement="top" data-original-title="Add next service" *ngIf="servicesOfApplication?.length > 0 && (metricServiceForm.value.identifiers.length < servicesOfApplication?.length)"><i class="fas fa-plus"></i></a></th>
                                      </tr>
                                    </thead>
                                    <tbody *ngFor="let metricservice of metricServiceForm.get('identifiers')['controls']; let i=index">                              
                                      <tr [formGroupName]=i>
                                        <td class="px-1">
                                          <div class="d-flex align-items-center">
                                            <select class="form-control" formControlName="service" [ngClass]="metricservice.get('service').invalid && metricservice.get('service').touched ? 'is-invalid':''">
                                              <option value="" [disabled]="true">Select</option>                            
                                              <option *ngFor="let service of servicesOfApplication" value="{{service.name}}"  >
                                                {{service.name}}</option>                           
                                            </select>
                                            <span class="mandatory ml-2">*</span>
                                          </div>
                                        </td>
                                        
                                        <td class="px-1">
                                          <div class="d-flex align-items-center">
                                            <input type="text" class="form-control" formControlName="baseline" placeholder="{variable1: service:baseapp}" [ngClass]="metricservice.get('baseline').invalid && metricservice.get('baseline').touched ? 'is-invalid':''">
                                            <span class="mandatory ml-2">*</span>
                                          </div>
                                        </td>
                                        <td class="px-1">
                                          <div class="d-flex align-items-center">
                                            <input type="text" class="form-control" formControlName="canary" placeholder="{variable1: service:canaryapp}" [ngClass]="metricservice.get('canary').invalid && metricservice.get('canary').touched ? 'is-invalid':''">
                                            <span class="mandatory ml-2">*</span>
                                          </div>
                                        </td>
                                        <!-- <td class="px-1">
                                         <a (click)="deleteMetricService(metricservice,i)" class="text-muted"><i class="fas fa-trash-alt"></i></a>
                                        </td> -->
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                                <!-- /.form-group -->
                              </div>
                              <!-- /.col-6 -->
                            </div>
                            <!-- /.row -->   
                           </form> 
                        </div>
                      </div>

                      
                      <!-- <div>{{formGroup.get('date').value?.toLocaleString()}}</div> -->

                      <!--
                      <div class="form-group text-muted">
                        <label>Baseline Identifier <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <input type="text" class="form-control col-sm-6" />
                      </div>
                      <div class="form-group text-muted">
                        <label>Canary Identifier <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <input type="text" class="form-control col-sm-6" />
                      </div>
                      <div class="form-group text-muted">
                        <label>Baseline StartTtime <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <input type="text" class="form-control col-sm-6" />
                      </div>
                      <div class="form-group text-muted">
                        <label>Canary Start Time <img src="../../../assets/images/help_icon.png" alt="icon" /></label>
                        <input type="text" class="form-control col-sm-6" />
                      </div> -->
                    </form>
                  </div>
              </div>
              
              <div id="manualTrigger-editor" role="tabpanel" aria-labelledby="manualTrigger-editor-tab" >
                <div class="col-12 maindiv" *ngIf = "selectedManualTriggerTab === 'manualTrigger-editor-tab'" >
                  <json-editor [options]="editorOptions" [data]="data" (change)="showManualTriggerJson($event)"></json-editor>
                </div>            
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-default" data-dismiss="modal" aria-label="Close" #manualTrigerModal>Cancel</button>
          <button type="submit" class="btn  btn-primary" *ngIf = "selectedManualTriggerTab === 'manualTrigger-form-tab'" (click)="submitManualTriggerForm()" [disabled]='!manualTriggerForm.valid && !logServiceForm.valid'>Trigger</button>
          <button  class="btn  btn-primary" *ngIf = "selectedManualTriggerTab === 'manualTrigger-editor-tab'" (click)="submitManualTriggerData()" data-dismiss="modal">Trigger</button>
        </div>
        <!-- /.modal-footer -->
      </div>
    </div>
  </div>

    <div class="modal bd-example-modal-lg fade " id="reclassificationHistory" tabindex="-1" role="dialog" aria-labelledby="reclassificationHistory" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-width" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Logs Reclassification History</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <i class="fa fa-times"></i>
            </button>
          </div>
          <div style="min-height: 400px;" class="modal-body">
            <div *ngIf="reclassificationHistory != null">
            <div *ngFor='let feedbackHistory of reclassificationHistory.feedbackHistory' style="border: 1px solid black;  margin-top: 5px; margin-bottom: 5px; ">
              <div style="padding-top:10px ; background-color: #eef8fc; padding: 3px;">{{feedbackHistory.clusterString}}</div>
              <div style="padding-top:10px ; padding: 3px;" >ReClassified From <span [ngClass]="{'text-danger':feedbackHistory.existingTopic == 'CRITICAL ERROR', 'text-error':feedbackHistory.existingTopic == 'ERROR','text-warning':feedbackHistory.existingTopic == 'WARN','text-muted':feedbackHistory.existingTopic=='IGNORE'}">{{feedbackHistory.existingTopic}}</span> To <span [ngClass]="{'text-danger':feedbackHistory.newTopic == 'CRITICAL ERROR', 'text-error':feedbackHistory.newTopic == 'ERROR','text-warning':feedbackHistory.newTopic == 'WARN','text-muted':feedbackHistory.newTopic=='IGNORE'}">{{feedbackHistory.newTopic}}</span></div>
              <div style="padding-top:10px ; padding: 3px;"><span>{{feedbackHistory.timestamp | changeTImestamptotime}}</span> Comments : {{feedbackHistory.feedbackComment}}</div>
            </div>
            </div>
            <div *ngIf="reclassificationHistory == null">
                No Data Present
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-default" data-dismiss="modal" aria-label="Close">OK</button>
          </div>
          <!-- /.modal-footer -->
        </div>
      </div>
    </div>

    <div class="page-content flex-grow-1">
      <div class="page_title page_title_inner title_icon px-3 d-flex align-items-center" *ngIf="applicationExists"> 
        <h3><img src="../../../assets/images/application-icon.png" alt="" />{{selectedApplicationName}} <span  *ngIf="canaryIdExists">» {{control.value}} » {{serviceNameInfo['serviceName'] !== undefined ? serviceNameInfo['serviceName']: ''}}</span> </h3>
        <div class="page_access d-flex ml-auto">
          <button class="btn btn-default" data-toggle="modal" data-target="#manualTrigger" data-backdrop="static" data-keyboard="false" [disabled]="applications?.length <= 0">Manual Trigger</button>
        </div>
        <div class="page_access d-flex ml20" *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'" >
          <button (click)="getReclassifiactionHistory()" class="btn btn-default" data-toggle="modal" data-target="#reclassificationHistory" data-backdrop="static" data-keyboard="false">Reclassification History</button>
        </div>
        <!-- /.page_access ml-auto -->
      </div>
      <!-- /.page_title d-flex -->

      <div class="row no-gutters" *ngIf="canaryIdExists">
        <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12">
          <mat-drawer-container class="example-container" autosize>
            <mat-drawer #sideNav class="example-sidenav" [position]="'end'" mode="side" opened="false">
              <div class="rightBox m-0 position-sticky">
                <div class="rightBox_header bg-white d-flex align-items-center">
                  <div class="btns_icon d-flex ml-auto">
                    <button class="btn p-0" data-toggle="tooltip" data-placement="top" title="Download debug data" (click)="downloadDebugData(canaryId)"><img src="../../../assets/images/download.png" alt="download" /></button>
                    <!-- <button class="btn p-0 ml-2" data-toggle="tooltip" data-placement="top" title="Add"><img src="../../../assets/images/plus_icon.png" alt="plus" /></button>
                    <button class="btn p-0 ml-2" data-toggle="tooltip" data-placement="top" title="Edit"><img src="../../../assets/images/edit_icon.png" alt="edit" /></button> -->
                  </div>
                </div>
                <div class="rightBox_body pt-0">
                  
                  
                  
      
                  <div class="table-responsive">
                    <table class="table table-sm table-sm-text text-left table-no-bordered mb-0">
                        <!-- <tr>
                          <td>
                            <p [innerHTML]=" sent | changetextcolor:arr"></p>
                          </td>
                        </tr> -->
                        <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                          <td width="170">Log Template:</td>
                          <td  title="{{deploymentServiceInformation['logTemplateName']}}">{{deploymentServiceInformation['logTemplateName'] | ellipsis:22}} 
                            <i class="fa fa-clipboard" role="button" aria-hidden="true" ngxClipboard [cbContent]="deploymentServiceInformation['logTemplateName']"></i>  
                          </td>
                        </tr>
                        <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                          <td>Metric Template:</td>
                          <td  title="{{deploymentServiceInformation['metricTemplateName']}}">{{deploymentServiceInformation['metricTemplateName'] | ellipsis:22}} 
                            <i class="fa fa-clipboard" role="button" aria-hidden="true" ngxClipboard [cbContent]="deploymentServiceInformation['metricTemplateName']"></i>  
                          </td>
                        </tr>
                    </table>
                    <hr />
                  <table class="table table-sm table-sm-text text-left table-no-bordered mb-0">
                    <tbody>                     
                      <tr class="font-weight-bold" *ngIf="(deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics') && !deploymentServiceInformation['autoBaseline']" >
                        <td width="170">Log Baseline: </td>
                        <td  *ngIf="deploymentServiceInformation['version1name'] != '' && deploymentServiceInformation['version1name'] != null" title="{{deploymentServiceInformation['version1name']}}">{{deploymentServiceInformation['version1name'] | ellipsis:22}} 
                          <i class="fa fa-clipboard" role="button" aria-hidden="true" ngxClipboard [cbContent]="deploymentServiceInformation['version1name']"></i>  
                        </td>
                        <td  *ngIf="deploymentServiceInformation['version1name'] == '' || deploymentServiceInformation['version1name'] == null" >N/A                          
                        </td>
                      </tr>
                  
                      <tr class="font-weight-bold" *ngIf=" deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Metric Baseline: </td>
                        <td *ngIf="deploymentServiceInformation['metricVersion1Name'] != '' && deploymentServiceInformation['metricVersion1Name'] != null" title="{{deploymentServiceInformation['metricVersion1Name']}}">{{deploymentServiceInformation['metricVersion1Name'] | ellipsis:22}} 
                          <i class="fa fa-clipboard" role="button" aria-hidden="true" ngxClipboard [cbContent]="deploymentServiceInformation['metricVersion1Name']"></i>  
                        </td>
                        <td  *ngIf="deploymentServiceInformation['metricVersion1Name'] == '' || deploymentServiceInformation['metricVersion1Name'] == null" >N/A                          
                        </td>
                      </tr>
                      <tr *ngIf="!deploymentServiceInformation['autoBaseline']">
                        <td >Start time:</td>
                        <td>{{deploymentServiceInformation['v1StartTime'] | date:'medium'}}</td>
                      </tr>
                      <tr *ngIf="!deploymentServiceInformation['autoBaseline']">
                        <td >End time:</td>
                        <td>{{deploymentServiceInformation['v1EndTime'] | date:'medium'}}</td>
                      </tr>
                    </tbody>
                  </table>
                  <hr />
                  <table class="table table-sm table-sm-text text-left table-no-bordered mb-0">
                    <tbody>
                      <tr class="font-weight-bold" *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td width="170"> Log New Release:</td>
                        <td *ngIf="deploymentServiceInformation['version2name'] != '' && deploymentServiceInformation['version2name'] != null" title="{{deploymentServiceInformation['version2name']}}">{{deploymentServiceInformation['version2name'] | ellipsis:22}} 
                          <i class="fa fa-clipboard" role="button" aria-hidden="true" ngxClipboard [cbContent]="deploymentServiceInformation['version2name']"></i>  
                        </td>
                        <td  *ngIf="deploymentServiceInformation['version2name'] == '' || deploymentServiceInformation['version2name'] == null" >N/A                          
                        </td>
                      </tr>
                      <tr class="font-weight-bold" *ngIf="deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td > Metric New Release:</td>
                        <td *ngIf="deploymentServiceInformation['metricVersion2Name'] != '' && deploymentServiceInformation['metricVersion2Name'] != null" title="{{deploymentServiceInformation['metricVersion2Name']}}">{{deploymentServiceInformation['metricVersion2Name'] | ellipsis:22}} 
                          <i class="fa fa-clipboard" role="button" aria-hidden="true" ngxClipboard [cbContent]="deploymentServiceInformation['metricVersion2Name']"></i>  
                        </td>
                        <td  *ngIf="deploymentServiceInformation['metricVersion2Name'] == '' || deploymentServiceInformation['metricVersion2Name'] == null" >N/A                          
                        </td>
                      </tr>
                      <tr>
                        <td >Start time:</td>
                        <td>{{deploymentServiceInformation['v2StartTime'] | date:'medium'}}</td>
                      </tr>
                      <tr>
                        <td >End time:</td>
                        <td>{{deploymentServiceInformation['v2EndTime'] | date:'medium'}}</td>
                      </tr>
                    </tbody>
                  </table>
                  <hr />
                
                  
                  <table  class="table table-sm table-sm-text text-left table-no-bordered mb-0">
                    <tbody>
                      <tr>
                        <td width="170">Analysis type:</td>
                        <td>{{deploymentApplicationHealth['analysisType']}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Log Status:</td>
                        <td>{{deploymentServiceInformation['logStatus']}}</td>
                      </tr>
                      
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Metric Status:</td>
                        <td>{{deploymentServiceInformation['metricStatus']}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Log Score:</td>
                        <td><span *ngIf="deploymentServiceInformation['logScore']>-1">{{deploymentServiceInformation['logScore']}}</span>
                        <span *ngIf="deploymentServiceInformation['logScore']<0 || deploymentServiceInformation['logScore']==null"> N/A </span></td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Metric Score:</td>
                        <td><span *ngIf="deploymentServiceInformation['metricScore']>-1">{{deploymentServiceInformation['metricScore']}}</span>
                        <span *ngIf="deploymentServiceInformation['metricScore']<0 || deploymentServiceInformation['metricScore']==null"> - </span></td>
                      </tr>
                      <tr *ngIf="(deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics') && !deploymentServiceInformation['autoBaseline']">
                        <td >Baseline size:</td>
                        <td>{{humanFileSize(deploymentServiceInformation['fileStat'] !== undefined ? deploymentServiceInformation['fileStat']['v1FileSize']:null,true)}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >New Release size:</td>
                        <td>{{humanFileSize(deploymentServiceInformation['fileStat'] !== undefined ? deploymentServiceInformation['fileStat']['v2FileSize']:null,true)}}</td>
                      </tr>
                      <tr *ngIf="(deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics') && !deploymentServiceInformation['autoBaseline']">
                        <td >Baseline lines:</td>
                        <td>{{deploymentServiceInformation['fileStat'] != undefined ? (deploymentServiceInformation['fileStat']['v1LogLen'] !== undefined?deploymentServiceInformation['fileStat']['v1LogLen']:null) : 'N/A'}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >New Release lines:</td>
                        <td>{{deploymentServiceInformation['fileStat'] != undefined ? (deploymentServiceInformation['fileStat']['v2LogLen'] !== undefined?deploymentServiceInformation['fileStat']['v2LogLen']:null) : 'N/A'}}</td>
                      </tr>
                      <tr data-toggle="tooltip" data-placement="left" title="Analysis Duration In Minutes">
                        <td >Analysis Duration:</td>
                        <td>{{deploymentServiceInformation ? (deploymentServiceInformation['analysisDuration'] | millisecondsToMins) : 'N/A'}}</td>
                      </tr>
                      <tr>
                        <td >Lifetime Hours:</td>
                        <td>{{deploymentServiceInformation ? deploymentServiceInformation['lifetimeInHours']: 'N/A'}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td ><span title="Reclassification Duration">Reclassification Dur.</span>:</td>
                        <td>{{(deploymentServiceInformation != undefined && deploymentServiceInformation['reclassificationDuration'] != null) ? deploymentServiceInformation['reclassificationDuration']: 'N/A'}}</td>
                      </tr>                      
                      <tr>
                        <td >Interval Minutes:</td>
                        <td>{{deploymentServiceInformation ? deploymentServiceInformation['intervalMinutes']: 'N/A'}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Regular Expression:</td>
                        <td>{{deploymentServiceInformation && deploymentServiceInformation['regularExpression'] != "" ? deploymentServiceInformation['regularExpression']: 'N/A'}}</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Response Key:</td>
                        <td>{{deploymentServiceInformation && deploymentServiceInformation['regExResponseKey'] != "" ? deploymentServiceInformation['regExResponseKey']: 'N/A'}} </td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Algorithm:</td>
                        <ng-container *ngIf="deploymentServiceInformation">
                          <td *ngIf="deploymentServiceInformation['algorithm']==='spell'">{{deploymentServiceInformation['algorithm']==='spell' ? 'LCS' : 'N/A'}}</td>
                          <td *ngIf="deploymentServiceInformation['algorithm']==='perl'">{{deploymentServiceInformation['algorithm']==='perl' ? 'Threshold' : 'N/A'}}</td>
                        </ng-container>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >Baseline logs:</td>
                        <td *ngIf="deploymentServiceInformation['baselineKibanaUrl'] != null"><a href="{{deploymentServiceInformation['baselineKibanaUrl']}}" target="_blank" class="text-dark font-weight-bold underline">View Logs</a></td>
                        <td *ngIf="deploymentServiceInformation['baselineKibanaUrl'] === null">N/A</td>
                      </tr>
                      <tr *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                        <td >New Release logs: </td>
                        <td *ngIf="deploymentServiceInformation['canaryKibanaUrl'] != null"><a href="{{deploymentServiceInformation['canaryKibanaUrl']}}" target="_blank" class="text-dark font-weight-bold underline">View Logs</a></td>
                        <td *ngIf="deploymentServiceInformation['canaryKibanaUrl'] === null">N/A</td>
                        
                      </tr>
                    </tbody>
                  </table>
                  </div>
                </div>
              </div>
            </mat-drawer>
          
            <div class="example-sidenav-content">
              <div class="d-flex flex-column analysisMainDiv">
                <div class="summaryToggleBtn d-flex ml20">
                  <div class="chart_ratio mb-2 text-center d-flex   ">
                    <div class="chart_value flex-grow-1 padding10LeftRight"  [ngClass]= "{'cv_high':serviceNameInfo['status'] === 'Success','cv_low':serviceNameInfo['status'] === 'Fail','cv_medium':serviceNameInfo['status'] === 'Review'}">
                      <div class="cv_heighlight"  *ngIf="serviceNameInfo['finalScore']>-1">{{serviceNameInfo['finalScore'] | roundOff}}</div>
                      <div class="cv_heighlight"  *ngIf="serviceNameInfo['finalScore']<0"> - </div>
                      <div class="cv_heighlight"   [ngClass]= "{'text-danger':serviceNameInfo['status'] === 'Fail','text-success':serviceNameInfo['status'] === 'Success','text-warning':serviceNameInfo['status'] === 'Review','text-muted':serviceNameInfo['status'] === 'InProgress'}">{{serviceNameInfo['status']}}</div>                      
                      
                      
                    </div>
                    
                  </div>
                  <div *ngIf="deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'" class="chart_ratio mb-2 text-center d-flex widthDetailScore ml20">
                    <div class="chart_value flex-grow-1" [ngClass]= "{'cv_high':serviceNameInfo['metricScore'] >= deploymentApplicationHealth['maximumCanaryScore'],'cv_low':serviceNameInfo['metricScore'] <= deploymentApplicationHealth['minimumCanaryScore'],'cv_medium':serviceNameInfo['metricScore'] < deploymentApplicationHealth['maximumCanaryScore'] && serviceNameInfo['metricScore'] > deploymentApplicationHealth['minimumCanaryScore']}">
                      <div class="cv_heighlight" *ngIf="serviceNameInfo['metricScore']>-1" [ngClass]= "{'text-danger':serviceNameInfo['metricScore'] <= deploymentApplicationHealth['minimumCanaryScore'],'text-success':serviceNameInfo['metricScore'] >= deploymentApplicationHealth['maximumCanaryScore'],'text-warning':serviceNameInfo['metricScore'] < deploymentApplicationHealth['maximumCanaryScore'] && serviceNameInfo['metricScore'] > deploymentApplicationHealth['minimumCanaryScore']}">{{serviceNameInfo['metricScore'] | roundOff}}</div>
                      <div class="cv_heighlight" *ngIf="serviceNameInfo['metricScore']<0 || serviceNameInfo['metricScore']==null"> - </div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name" >Metrics</div>
                      <!-- /.cv_name -->
                    </div>
                    <div class="chart_value cv_alert flex-grow-1">
                      <div class="cv_heighlight lightRed">{{serviceNameInfo['metricsCount'] ? serviceNameInfo['metricsCount']['fail']:''}} </div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Failed</div>
                    </div>
                    <div class="chart_value cv_alert flex-grow-1">
                      <div class="cv_heighlight text-danger">{{serviceNameInfo['metricsCount'] ? serviceNameInfo['metricsCount']['critical']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name ">Critical</div>
                    </div>
                    <div class="chart_value cv_alert flex-grow-1">
                      <div class="cv_heighlight text-warning">{{serviceNameInfo['metricsCount'] ? serviceNameInfo['metricsCount']['watchlist']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Watchlist</div>
                    </div>
                    <div class="chart_value cv_alert flex-grow-1">
                      <div class="cv_heighlight">{{serviceNameInfo['metricsCount'] ? serviceNameInfo['metricsCount']['total']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Count</div>
                    </div>
                  </div>
                  <div *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'" class="chart_ratio mb-2 text-center d-flex widthDetailScore ml20" >
                    <div class="chart_value padding5LeftRight  flex-grow-1" [ngClass]= "{'cv_high':serviceNameInfo['logsScore'] >= deploymentApplicationHealth['maximumCanaryScore'],'cv_low':serviceNameInfo['logsScore'] <= deploymentApplicationHealth['minimumCanaryScore'],'cv_medium':serviceNameInfo['logsScore'] < deploymentApplicationHealth['maximumCanaryScore'] && serviceNameInfo['logsScore'] > deploymentApplicationHealth['minimumCanaryScore']}">
                      <div class="cv_heighlight" *ngIf="serviceNameInfo['logsScore']>-1" [ngClass]= "{'text-danger':serviceNameInfo['logsScore'] <= deploymentApplicationHealth['minimumCanaryScore'],'text-success':serviceNameInfo['logsScore'] >= deploymentApplicationHealth['maximumCanaryScore'],'text-warning':serviceNameInfo['logsScore'] < deploymentApplicationHealth['maximumCanaryScore'] && serviceNameInfo['logsScore'] > deploymentApplicationHealth['minimumCanaryScore']}" >{{serviceNameInfo['logsScore'] | roundOff }}</div>
                      <div class="cv_heighlight" *ngIf="serviceNameInfo['logsScore']<0 || serviceNameInfo['logsScore']==null"> - </div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Logs</div>
                    </div>
                    <div class="chart_value flex-grow-1">
                      <div class="cv_heighlight lightRed">{{serviceNameInfo['clusterCount'] ? serviceNameInfo['clusterCount']['critical']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Critical</div>
                    </div>
                    <div class="chart_value flex-grow-1">
                      <div class="cv_heighlight text-danger">{{serviceNameInfo['clusterCount'] ? serviceNameInfo['clusterCount']['error']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Error</div>
                    </div>
                    <div class="chart_value cv_alert flex-grow-1">
                      <div class="cv_heighlight text-warning">{{serviceNameInfo['clusterCount'] ? serviceNameInfo['clusterCount']['warning']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Warning</div>
                    </div>
                    <div class="chart_value cv_alert flex-grow-1">
                      <div class="cv_heighlight">{{serviceNameInfo['clusterCount'] ? serviceNameInfo['clusterCount']['total']:''}}</div>
                      <!-- /.cv_heighlight -->
                      <div class="cv_name">Cluster</div>
                    </div>
                  </div>

                  
                </div>
                <div class="pt-1 ">
                  <div class="row">
                    <div class="col-sm-11 noPaddingRight">
                      <ul class="nav tab-lined nav-tabs logAndMetricTabs" id="myTab" role="tablist" (click)="onClickTab($event.target.id)">
                        <li class="nav-item" *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'">
                          <a class="nav-link" [ngClass]="{'active': selectedTab == 'log-analysis'}"  id="log-analysis-tab" data-toggle="tab" role="tab" aria-controls="log-analysis" aria-selected="true">Log Analysis</a>
                        </li>
                        <li *ngIf="deploymentApplicationHealth['analysisType'] === 'Metrics Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'" class="nav-item">
                          <a class="nav-link" [ngClass]="{'active': selectedTab == 'metric-analysis'}" id="metric-analysis-tab" data-toggle="tab" role="tab" aria-controls="metric-analysis" aria-selected="true">Metric Analysis</a>
                        </li>
                        <!-- <li *ngIf="deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'" class="nav-item">
                          <a class="nav-link"  id="correlation-tab" data-toggle="tab" role="tab" aria-controls="correlation" aria-selected="true">Correlation</a>
                        </li> -->
                        <li class="nav-item">
                          <a class="nav-link" [ngClass]="{'active': selectedTab === 'correlation'}" id="correlation-tab" data-toggle="tab" role="tab" aria-controls="correlation" aria-selected="true">Correlation</a>
                        </li>
                        
                
                      </ul>
                </div>
                  <div class="nav-item ml-auto padding0 col-sm-1">
                    <button class="pull-right adjustwidth" data-toggle="tooltip" data-placement="left" title="Overall canary run information for the selected application"  id="sideButton" mat-button>
                      <div *ngIf="isShow" (click)="[sideNav.toggle(),getOverallInfo()]"><i  class="fa fa-chevron-right"></i><i  class="fa fa-chevron-right"></i></div>
                      <div *ngIf="!isShow" (click)="[sideNav.toggle(),getOverallInfo()]"><i  class="fa fa-chevron-left"></i><i  class="fa fa-chevron-left"></i></div>
                    </button>
                  </div>
                </div>
                  
                
                  <div class="tab-content" id="myTabContent" >
                    <div class="tab-pane p-4 fade " id="log-analysis" role="tabpanel" aria-labelledby="log-analysis-tab"
                    [ngClass]="{'active': selectedTab == 'log-analysis','show': deploymentApplicationHealth['analysisType'] === 'Logs Only' || deploymentApplicationHealth['analysisType'] === 'Logs and Metrics'}">
                        <ng-container *ngIf = "selectedTab === 'log-analysis'">
                          <app-log-analysis [applicationId]="applicationId" [canaryId]="control.value" [serviceId]="selectedServiceId" [isRerun]="isRerunLogs" [serviceStatus]="statusOfSelectedService" (selectedServiceIdFromChild)="getlogAnalysisData($event)" (enterdToLogLines)="getEventsFromLogAnalysis($event)"></app-log-analysis>
                        </ng-container>
                      </div>
                      <div class="tab-pane mp-4"  id="metric-analysis" role="tabpanel" aria-labelledby="metric-analysis-tab"
                      [ngClass]="{'active': selectedTab === 'metric-analysis'}">
                        <ng-container *ngIf = "selectedTab === 'metric-analysis'">
                          <app-metric-analysis [canaryId]="control.value" [serviceId]="selectedServiceId"></app-metric-analysis>
                        </ng-container>
                      </div>
                      <div class="tab-pane mp-4 "  id="correlation" role="tabpanel" aria-labelledby="correlation-tab"
                      [ngClass]="{'active': selectedTab === 'correlation'}">
                        <ng-container *ngIf = "selectedTab === 'correlation'">
                          <app-correlation [canaryId]="control.value" [serviceId]="selectedServiceId" [serviceList] = "deploymentServices.services" [analysisType]="deploymentApplicationHealth['analysisType']" (closeSideNav)="getEventsFromLogAnalysis($event)"></app-correlation>
                        </ng-container>
                      </div>
                  </div>
                </div>
                <!-- /.tab-lined -->
              </div>
            </div>
          
          </mat-drawer-container>
        </div>
      </div>

    <div  class="col-md-12" *ngIf="!applicationExists">
      <div>
        <div class="d-flex w-100 h-100 pt-3 pb-5">
          <div class="no_content m-auto pt-5">
           <h3 class="no-applications">No Applications!</h3>
            <p>Use Application Dashboard to create application</p>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="applicationExists && !canaryIdExists" class="col-md-12 pt-3">
      <div >
        <div class="d-flex w-100 h-100 pb-5">
          <div class="no_content m-auto">
           <h4 class="no-applications">No Canaries!</h4>
            <!-- <p>Manual Trigger can be used to create canary runs.</p> -->
          </div>
        </div>
      </div>
    </div>
  <!-- /.row -->
    </div>
    <!-- /.page-content -->
  </div>
</div>
<!-- /.main_content -->
<!-- <div class="main_content p-0 bg-white" *ngIf="deployementLoading">
  <div class="tab-pane d-flex flex-column bg-white h-100 fade show">
    <app-loading-screen></app-loading-screen>
   </div>
</div> -->